{% extends "base.html" %}
{% load l10n_tags %}

{% block title %}{{ project.name }}{% endblock %}

{% block links %}
{% comment %}
Comment out until we're finished refactoring activity
<link rel="alternate" type="atom/xml" href="{% locale_url activity_feed_object object_id=project.id type_id=type.id %}" />
{% endcomment %}
{% endblock %}

{% block breadcrumbs %}
  <div class="container">
    <nav>
      <a href="{% locale_url projects_gallery %}">{{ _('Projects') }}</a>
      <span class="arrow">&rsaquo;</span>
      <a href="{% locale_url projects_show slug=project.slug %}">{{ project.name }}</a>
    </nav>

    {% if user.get_profile == project.created_by %}
      <div id="project-actions">
	<div class="button"><a href="#">{{ _('Edit Project') }}</a></div>
	<div class="button"><a href="{% locale_url projects_contact_followers slug=project.slug %}">{{ _('Message Followers') }}</a></div>
      </div>
    {% endif %}

  </div> <!-- /.container -->
{% endblock %}

{% block bodyid %}project_landing{% endblock %}

{% block body %}
<div id="sidebar">
  <div id="project">

    <h1 id="project-name">{{ project.name }}</h1>

    <div id="project-follow" class="button">
      {% if following %}
	<form method="post" action="{% locale_url relationships_unfollow %}">
	  {% csrf_token %}
	  <input type="hidden" name="object_id" value="{{ project.id }}">
	  <input type="hidden" name="object_type_id" value="{{ type.id }}">
          <a class="submit-button" href="#">{{ _('Unfollow') }}</a>
        </form>
      {% else %}
	<form method="post" action="{% locale_url relationships_follow %}">
	  {% csrf_token %}
	  <input type="hidden" name="object_id" value="{{ project.id }}">
	  <input type="hidden" name="object_type_id" value="{{ type.id }}">
	  <a class="submit-button" href="#">{{ _('Follow Project') }}</a>
	</form>
      {% endif %}
    </div> <!-- /#project-follow -->

    <dl id="project-stats">
      <dt>Followers</dt>
      <dd>
	<a href="#">{{ project.followers|length }}</a>
      </dd>
      <dt>Updates</dt>
      <dd>{{ update_count }}</dd>

      <dt>Created</dt>
      <dd>August 2009</dd>
    </dl> <!-- /#project-stats -->

    <div id="project-summary">
      {{ project.description }}
    </div>

    <!-- TODO: support project media 
    <div id="project-icons">
      <img src="..." height="86" width="96">
      <img src="..." height="86" width="96">
    </div>-->

    <a id="project-description-link" href="#">View Full Project Description</a>

    <nav id="project-links">
      {% if links %}
	<ul>
	  {% for link in links %}
	    <li><a href="{{ link.url }}">{{ link.title }}</a></li>
	  {% endfor %}
	</ul>
      {% endif %}  
    </nav>

    <div id="project-lead">
      <a href="{{ project.created_by.get_absolute_url }}">
	<img class="member-picture" src="{{ MEDIA_URL }}{{ project.created_by.image_or_default }}" height="54" width="54">
      </a>

      <div class="member-details">
	<h3 class="member-name">
	  <a href="{{ project.created_by.get_absolute_url }}">{{ project.created_by.name }}</a>
	</h3>

	<div class="member-actions">
	  <div class="button">
	    <a href="#">{{ _('Follow User') }}</a>
	  </div>
	  <div class="button">
	    <a href="#">{{ _('Message') }}</a>
	  </div>
	</div>

	<div class="member-bio">
	  {{ project.created_by.bio }}
	</div>
	
      </div> <!-- /.member-details -->
    </div> <!-- /#project-lead -->
  </div> <!-- /#project -->
</div> <!-- /#sidebar -->

<div id="main">
  <div id="create-post">
    <div class="post-container">
      <form action="{% locale_url statuses_create_project project_id=project.id %}" method="post" id="post-project-status-update">
	{% csrf_token %}
	<input type="text" value="{{ _('Post a message to this project') }}" title="{{_('Post a message to this project')}}">
	<textarea name="status" title="{{_('Post a message to this project')}}"></textarea>
	
	<div class="status-and-actions">
	  <div class="post-char-count">750</div>
	  
	  <ul class="post-tags">
	    <li><span>{{ project.name }}</span></li>
	  </ul>

	  <div class="button update">
	    <a id="post-project-update" href="#">Post Update</a>
	  </div>

	</div> <!-- /.status-and-actions -->
	</form>
      </div> <!-- /.post-container -->
    </div> <!-- /.#create-post -->

    <ul id="posts">
      {% for activity in activities %}
	  {% include "activity/_activity_resource.html" %}
      {% endfor %}
    </ul>

</div> <!-- /#main -->

{% endblock %}
